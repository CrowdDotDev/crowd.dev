# image for building dependencies only
FROM python:3.8-bullseye as builder

RUN apt install -y --no-install-recommends gcc

WORKDIR /var/task

COPY . .

RUN python -m venv ./venv && . ./venv/bin/activate && \
  python --version && which python && \
  pip --version && which pip && \
  ls ./venv/bin

RUN  pip install psycopg2-binary && \
pip install -r requirements.txt && \
pip install -r requirements.dev.txt

ENTRYPOINT ["python", "-u", "python_worker.py"]
# ENTRYPOINT [ "tail", "-f", "/dev/null" ]

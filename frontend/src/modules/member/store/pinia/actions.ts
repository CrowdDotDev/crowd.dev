import { MemberService } from '@/modules/member/member-service';
import { customAttributesService } from '@/shared/modules/filters/services/custom-attributes.service';
import { FilterCustomAttribute } from '@/shared/modules/filters/types/FilterCustomAttribute';
import { FilterConfig } from '@/shared/modules/filters/types/FilterConfig';
import { MemberState } from '@/modules/member/store/pinia/state';
import { Pagination } from '@/shared/types/Pagination';
import { Member } from '@/modules/member/types/Member';

const { buildFilterFromAttributes } = customAttributesService();

export default {
  fetchMembers(this: MemberState, { body = {}, reload = false } :{ body?: any, reload?: boolean }): Promise<Pagination<Member>> {
    const mappedBody = reload ? { ...this.savedFilterBody, ...body } : body;
    this.selectedMembers = [];
    return MemberService.listMembers(mappedBody)
      .then((data: Pagination<Member>) => {
        this.members = data.rows;
        this.totalMembers = data.count;
        this.savedFilterBody = mappedBody;
        return Promise.resolve(data);
      })
      .catch((err) => {
        this.members = [];
        this.totalMembers = 0;
        return Promise.reject(err);
      });
  },
  getMemberCustomAttributes(this: MemberState): Promise<Record<string, FilterConfig>> {
    return MemberService.fetchCustomAttributes()
      .then(() => ({
        rows: [
          {
            id: '2650adcb-ccd0-4afc-8b26-7c271c1cbf38',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Company',
            name: 'company',
            options: [],
            createdAt: '2024-04-23T10:59:03.605Z',
            updatedAt: '2024-04-23T10:59:03.605Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'e4d061de-9b42-496f-a78b-d1f4c0d417f5',
            type: 'boolean',
            canDelete: false,
            show: false,
            label: 'is Deleted',
            name: 'isDeleted',
            options: [],
            createdAt: '2024-01-29T14:46:27.007Z',
            updatedAt: '2024-01-29T14:46:27.007Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'b9646e10-553d-4b7e-b5f6-67915e6ab74e',
            type: 'boolean',
            canDelete: true,
            show: true,
            label: 'Reviewed',
            name: 'reviewed',
            options: [],
            createdAt: '2024-01-03T10:08:17.808Z',
            updatedAt: '2024-01-03T10:08:17.808Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '5418959c-7410-40a8-bce7-a3635291bd29',
            updatedById: '5418959c-7410-40a8-bce7-a3635291bd29',
          },
          {
            id: '68a1ff90-45ad-11ee-83e3-31c39ec3ebd9',
            type: 'number',
            canDelete: false,
            show: true,
            label: 'Karma',
            name: 'karma',
            options: null,
            createdAt: '2023-08-28T14:15:58.217Z',
            updatedAt: '2023-08-28T14:15:58.217Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: null,
            updatedById: null,
          },
          {
            id: 'f48783b0-45ab-11ee-9c03-ed881c4f325b',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Timezone',
            name: 'timezone',
            options: null,
            createdAt: '2023-08-28T14:05:33.930Z',
            updatedAt: '2023-08-28T14:05:33.930Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: null,
            updatedById: null,
          },
          {
            id: '2d4ea38e-f558-42ee-a9a7-69550abe1139',
            type: 'boolean',
            canDelete: true,
            show: true,
            label: 'Organization Website',
            name: 'organizationWebsite',
            options: [],
            createdAt: '2023-08-24T16:15:40.023Z',
            updatedAt: '2023-08-24T16:15:40.023Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'd578ba4c-2af0-4499-93a2-90104dce834b',
            type: 'boolean',
            canDelete: true,
            show: true,
            label: 'Organization Logo',
            name: 'organizationLogo',
            options: [],
            createdAt: '2023-08-24T16:15:14.506Z',
            updatedAt: '2023-08-24T16:15:14.506Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'c3b404e9-1281-427b-a3de-b0be645bdd2a',
            type: 'boolean',
            canDelete: true,
            show: true,
            label: 'Organization Name',
            name: 'organizationName',
            options: [],
            createdAt: '2023-08-24T16:14:48.803Z',
            updatedAt: '2023-08-24T16:14:48.803Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '085b79e0-dd29-48f4-9b07-dae39c526759',
            type: 'special',
            canDelete: false,
            show: true,
            label: 'Certifications',
            name: 'certifications',
            options: [],
            createdAt: '2023-07-07T13:49:38.652Z',
            updatedAt: '2024-01-30T04:08:02.543Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: 'c8680691-a28f-4c41-a43b-140a8cde4f4e',
            updatedById: 'c8680691-a28f-4c41-a43b-140a8cde4f4e',
          },
          {
            id: '712bb009-3c35-4a11-841a-eb4d2ec136c8',
            type: 'special',
            canDelete: false,
            show: true,
            label: 'Work Experiences',
            name: 'workExperiences',
            options: [],
            createdAt: '2023-07-06T14:56:17.315Z',
            updatedAt: '2024-01-31T07:20:02.420Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'a3016e9b-0bd2-42a8-9d19-de9b0e7b139e',
            type: 'special',
            canDelete: false,
            show: true,
            label: 'Education',
            name: 'education',
            options: [],
            createdAt: '2023-07-06T14:56:17.308Z',
            updatedAt: '2024-01-31T07:20:02.421Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '1ca582ba-4bb4-4961-8db6-15ca2f261d36',
            type: 'number',
            canDelete: false,
            show: true,
            label: 'Years of Experience',
            name: 'yearsOfExperience',
            options: [],
            createdAt: '2023-07-06T14:56:17.301Z',
            updatedAt: '2024-02-05T23:34:02.733Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '20552843-3cef-46d9-966d-42f7259534ae',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Country',
            name: 'country',
            options: [],
            createdAt: '2023-07-06T14:56:17.294Z',
            updatedAt: '2024-02-05T23:34:02.725Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '53556d7b-8968-464f-b661-c20adb24c6f3',
            type: 'multiSelect',
            canDelete: false,
            show: true,
            label: 'Expertise',
            name: 'expertise',
            options: null,
            createdAt: '2023-07-06T14:56:17.286Z',
            updatedAt: '2024-01-31T07:20:02.420Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: 'e0f40f66-ea2d-4dd1-a3e8-4f65f97fde47',
          },
          {
            id: 'a9d9fedc-72a4-4ff2-82c5-25e360aa6e5b',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Seniority Level',
            name: 'seniorityLevel',
            options: [],
            createdAt: '2023-07-06T14:56:17.279Z',
            updatedAt: '2024-02-05T23:34:02.718Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '59a25d16-5b4b-403e-8f19-d8acdbfee6e3',
            type: 'special',
            canDelete: false,
            show: true,
            label: 'Awards',
            name: 'awards',
            options: [],
            createdAt: '2023-07-06T14:56:17.269Z',
            updatedAt: '2024-01-17T16:34:03.076Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '1c7f9ca0-7a03-4e10-9573-16f626c9c597',
            type: 'multiSelect',
            canDelete: false,
            show: true,
            label: 'Programming Languages',
            name: 'programmingLanguages',
            options: null,
            createdAt: '2023-07-06T14:56:17.254Z',
            updatedAt: '2024-02-05T23:34:02.728Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: 'e0f40f66-ea2d-4dd1-a3e8-4f65f97fde47',
          },
          {
            id: 'c1be5e0a-414e-4104-8626-9a272e05ea4c',
            type: 'multiSelect',
            canDelete: false,
            show: true,
            label: 'Languages',
            name: 'languages',
            options: null,
            createdAt: '2023-07-06T14:56:17.247Z',
            updatedAt: '2024-01-31T07:20:02.419Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: 'ebbec86d-c54c-4891-afa4-4e469d286932',
          },
          {
            id: 'a9cf8a43-30eb-43a9-9311-f3ed304ac1d9',
            type: 'multiSelect',
            canDelete: false,
            show: true,
            label: 'Skills',
            name: 'skills',
            options: null,
            createdAt: '2023-07-06T14:56:17.240Z',
            updatedAt: '2024-02-05T23:34:02.737Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: 'e0f40f66-ea2d-4dd1-a3e8-4f65f97fde47',
          },
          {
            id: '2d57f300-1605-4e6e-9fb2-65896ef9af8e',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Name',
            name: 'name',
            options: [],
            createdAt: '2023-07-06T14:56:17.216Z',
            updatedAt: '2023-07-06T14:56:17.216Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'c41d0d5a-5394-48ca-93c3-0c738f03b0e0',
            type: 'string',
            canDelete: false,
            show: false,
            label: 'Source Id',
            name: 'sourceId',
            options: [],
            createdAt: '2023-07-06T14:56:17.177Z',
            updatedAt: '2023-07-06T14:56:17.177Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '2d05fac4-1720-466b-ba65-353d4624c955',
            type: 'url',
            canDelete: false,
            show: false,
            label: 'Avatar url',
            name: 'avatarUrl',
            options: [],
            createdAt: '2023-07-06T14:56:17.162Z',
            updatedAt: '2023-07-06T14:56:17.162Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'c03b2a12-8da2-4aed-bb49-05d0b62820f8',
            type: 'url',
            canDelete: false,
            show: true,
            label: 'Website',
            name: 'websiteUrl',
            options: [],
            createdAt: '2023-07-06T14:56:17.145Z',
            updatedAt: '2023-07-06T14:56:17.145Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '2b043139-3af1-4a34-83d9-c5c096b67f87',
            type: 'boolean',
            canDelete: false,
            show: true,
            label: 'is Hireable',
            name: 'isHireable',
            options: [],
            createdAt: '2023-07-06T14:56:17.134Z',
            updatedAt: '2023-07-06T14:56:17.134Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'ba8963af-f0a5-4d64-99be-87c135b35386',
            type: 'boolean',
            canDelete: false,
            show: false,
            label: 'is Organization',
            name: 'isOrganization',
            options: [],
            createdAt: '2023-07-06T14:56:16.599Z',
            updatedAt: '2023-07-06T14:56:16.599Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '0438a0b7-a8d8-41e3-854c-dc8b7583d2c2',
            type: 'boolean',
            canDelete: false,
            show: false,
            label: 'is Bot',
            name: 'isBot',
            options: [],
            createdAt: '2023-07-06T14:56:16.591Z',
            updatedAt: '2023-07-06T14:56:16.591Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'f9de0d9c-eeaa-48ed-b8c8-5def979b5118',
            type: 'boolean',
            canDelete: false,
            show: false,
            label: 'is Team Member',
            name: 'isTeamMember',
            options: [],
            createdAt: '2023-07-06T14:56:16.583Z',
            updatedAt: '2023-07-06T14:56:16.583Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'c1c8e793-d9c0-49d9-ad7b-b3ec0e47131b',
            type: 'url',
            canDelete: false,
            show: true,
            label: 'Url',
            name: 'url',
            options: [],
            createdAt: '2023-07-06T14:56:16.575Z',
            updatedAt: '2023-07-06T14:56:16.575Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'd8051a26-c428-464f-a43c-caf279da178d',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Location',
            name: 'location',
            options: [],
            createdAt: '2023-07-06T14:56:16.568Z',
            updatedAt: '2023-07-06T14:56:16.568Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: 'e31a4af8-3064-4465-890d-94f824420336',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Bio',
            name: 'bio',
            options: [],
            createdAt: '2023-07-06T14:56:16.559Z',
            updatedAt: '2024-01-31T07:20:02.416Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
          {
            id: '0a7441e5-4094-42ea-85ac-f33aebdff0c4',
            type: 'string',
            canDelete: false,
            show: true,
            label: 'Job Title',
            name: 'jobTitle',
            options: [],
            createdAt: '2023-07-06T14:56:16.551Z',
            updatedAt: '2023-07-06T14:56:16.551Z',
            tenantId: '875c38bd-2b1b-4e91-ad07-0cfbabb4c49f',
            createdById: '9d9661b7-9ad1-48af-9090-1d6497233537',
            updatedById: '9d9661b7-9ad1-48af-9090-1d6497233537',
          },
        ],
        count: 31,
      }))
      .then(({ rows }: {rows: FilterCustomAttribute[]}) => {
        this.customAttributes = rows;
        this.customAttributesFilter = buildFilterFromAttributes(rows);
        return Promise.resolve(this.customAttributesFilter);
      });
  },
  addToMergeMember(this: MemberState, toMergeId: string, toMergeGrandParentId: string) {
    this.toMergeMember = {
      id: toMergeId,
      segmentId: toMergeGrandParentId,
    };
  },

  removeToMergeMember(this: MemberState) {
    this.toMergeMember = null;
  },
};

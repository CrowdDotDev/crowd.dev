NODE segments_filteredd_0
SQL >
    %
    SELECT "segmentId" as id, repositories
    FROM insightsProjects FINAL
    where
        1 = 1
        {% if defined(project) %}
            AND slug = {{ String(project, description="Filter by project slug", required=True) }}
        {% else %} AND false
        {% end %}
        {% if defined(repo) %}
            AND has(
                insightsProjects.repositories,
                {{ String(repo, description="Filter activity repo", required=False) }}
            )
        {% end %}

DESCRIPTION >
    Incremental catch-up from activities into activities_backup using watermark on updatedAt.

TAGS "Activity preprocessing pipeline"

NODE activities_backup_catchup_v1
SQL >
    SELECT *
    FROM activities
    WHERE updatedAt >= addHours((SELECT max(updatedAt) FROM activities_backup), -12)

TYPE COPY
TARGET_DATASOURCE activities_backup
COPY_MODE append
COPY_SCHEDULE @on-demand